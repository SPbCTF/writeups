# DamCTF 2021
### web/bouncy-box

Автор врайтапа: Аким Бырков ([@darkhole1](https://t.me/darkhole1))

# Задание

#### `web/bouncy-box`, автор BobbySinclusto

This game is extremely fun. So fun that some people have been playing it for over 3 years!

[bouncy-box.chals.damctf.xyz](https://bouncy-box.chals.damctf.xyz/)

### Решение

Посмотрев на описания таска и на скорборд, мы находим там "VIP" пользователей. Зарегистрировать своего пользователя нельзя, остаётся только думать, как войти под одним из VIP пользователей.

Тыкаем стандартные `'` в форму входа и получаем в ответ 500 - верный признак того, что форма уязвима к sql инъекциям. Пишем в какое-нибудь поле ввода `' or 1 ; --` и получаем VIP аккаунт с заветной кнопочкой "Free flag!"

![](https://img.vos.uz/mu824br3.png)

Нас ждут тут два облома: для флага требуется логин-пароль и форма не уязвима к sql инъекциям. Выход прост: вытащить пароль из базы данных, но дело осложнено тем, что у нас "слепая" инъекция, мы не можем просто так взять и получить результат из базы данных. Варианта тут целых два. Первый заключается в написании своего собственного скрипта который будет подбирать по букве через оператор like, грубо говоря вводя такие данные `username' and password like 'part%' ; --`. Я сообразил об этом пути решения только после того, как решил таск, так что детально этот подход не тестировал.

Другой вариант, проще и одновременно дольше - использовать sqlmap. Он может сам перебирать буквы, но делает это через sleep, что очень медленно, поэтому его надо буквально тыкнуть в нужные данные, иначе подбор занимает неприличное количество времени. Готовая команда для подбора пароля пользователя "boxy_mcbounce":

```bash
sqlmap -u https://bouncy-box.chals.damctf.xyz/login --data '{"username":"BobbySincluston","password":"asdasdasd","score":0}' --dump -D scores -T users -C password --where="username='boxy_mcbounce'"
```

Подождав много времени, наконец-то получается заветный пароль `B0UncYBouNc3`. Дальнейшее решение сводится к простому входу под конкретным пользователем.
